#!/usr/bin/env bash

# Set custom predicate
pred='select(.kind != "style")' # We want swift-format to do most of the actual formatting

# Set predicate to exclude analyzer rules
predNoAnalyzer='select(.analyzer == false)'

# Set header comment
header="# Generated using:\n#   swiftlint $(swiftlint --version)\n# Predicates:\n#   $predNoAnalyzer\n#   $pred"

# Open final string
final="$header\n\nonly_rules:"

# Open loop through specifified rules
while read -r rule
do

	# Append rule to final
	final="$final\n  - $rule"

done < <(
	swiftlintToJson | \
		jq '.[]' | jq "$predNoAnalyzer" | jq "$pred" | jq -r '.id'
)

echo -e "$final"
